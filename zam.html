<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>W3M Docs - ZAM</title>
<link rel="stylesheet" href="./style/style.css" type="text/css" media="all" />
</head>

<body>
<div class="banner"><a href="index.html" name="top">index</a>/ZAM
</div>
<div class="totop"><a href="zam.html#top">Top</a></div>

<div class="listitems"><a href="zam.html#AggroSystem">AggroSystem</a></div>
<div class="listitems"><a href="zam.html#BuffSystem">BuffSystem</a></div>
<div class="listitems"><a href="zam.html#CastingBar">CastingBar</a></div>
<div class="listitems"><a href="zam.html#DamageSystem">DamageSystem</a></div>
<div class="listitems"><a href="zam.html#MultipleAbility">MultipleAbility</a></div>
<div class="listitems"><a href="zam.html#PlayerUnitList">PlayerUnitList</a></div>
<div class="listitems"><a href="zam.html#Projectile">Projectile</a></div>
<div class="listitems"><a href="zam.html#SpellReflection">SpellReflection</a></div>
<div class="listitems"><a href="zam.html#StunUtils">StunUtils</a></div>
<div class="listitems"><a href="zam.html#UnitProperty">UnitProperty</a></div>
<div class="listitems"><a href="zam.html#ZAMCore">ZAMCore</a></div>

<div class="items"><a name="AggroSystem"></a>AggroSystem</div>
<pre class="docs">
function IsInCombat() -> boolean
function GetFirstAggro(unit u) -> unit
function AggroTarget(unit a, unit b, real amt)
function AggroAll(unit a, real amt)
function AggroClear(unit a, real percentage)

struct AggroList {
    unit aggros[MAX_PLAYER_UNITS];
    real aps[MAX_PLAYER_UNITS];
    integer aggrosN;
    
    method destroy()
    method locate(unit u) -> integer
    method aggroBy(unit s, real amt)
    method sort() -> unit
    method add(unit u)
    method remove(integer i)
    method delete(unit u)
    static method operator[](unit u) -> thistype
    static method create(unit u) -> thistype
}
</pre>

<div class="items"><a name="BuffSystem"></a>BuffSystem</div>
<pre class="docs">
type BuffOnRemove extends function(Buff);
type BuffOnEffect extends function(Buff);

struct BuffResult {
    static boolean isNew;
}

function GetLastStolen(unit u) -> Buff
function SetLastStolen(unit u, Buff buf)

struct BuffEffect {
    Buff parent;
    effect eff;
    string path;
    string point;
    
    method destroy()        
    method remove()        
    method refresh()        
    static method create(string path, Buff parent, string point) -> thistype 
}

struct BuffData {
    static integer instances = 0;
    BuffType bt;
    unit caster;
    unit target;
    boolean isShield;
    real interval;
    integer tick;
    BuffOnRemove bor;
    BuffOnEffect boe;
    integer i0, i1, i2;
    real r0, r1, r2;
    BuffEffect e0, e1;
    
    method destroy()        
    static method create() -> thistype
}

struct Buff {
    static integer instances = 0;
    Buff next;
    BuffData bd;
    timer tm;
    
    method destroy()        
    method onRemove()
    method refresh()        
    method run()     
    static method cast(unit caster, unit target, integer bid) -> Buff
}

struct BuffSlot {
    static HandleTable ht;
    unit u;
    Buff top;
    
    method push(Buff b)        
    method dispel(integer buffCate, integer buffPoly) -> Buff        
    method dispelByBuff(Buff buf)        
    method removeAllBuff()         
    method cancel(Buff buf)        
    method getBuffByBid(integer bid) -> Buff        
    method absorb(real amount) -> real         
    method print()        
    static method operator[] (unit u) -> thistype
}

struct BuffType {
    static Table ht;
    integer bid;
    integer buffCate;
    integer buffPoly;
    
    static method operator[] (integer bid) -> thistype         
    static method register(integer bid, integer buffCate, integer buffPoly)         
}
</pre>

<div class="items"><a name="CastingBar"></a>CastingBar</div>
<pre class="docs">
//==============================================================================
//  Usage:
//=========
//  CastingBar.create(response).launch();
//  
//  CastingBar cb = CastingBar.create([response]);
//  cb.haste = [percentage];
//  cb.launch();
//
//  CastingBar.create(response).channel([nodes]);
//==============================================================================
public type CastBarFinishCast extends function(CastData);

public function IsLastSpellSuccess(unit whichUnit) -> boolean
public function IsUnitChanneling(unit whichUnit) -> boolean

public struct CastingBar {
    SpellData sd;
    CastBarFinishCast finishResponse;
    unit caster, target;
    unit bar;
    real targetX, targetY;
    boolean success;
    integer channeling; // 0 not channeling; 1 normal; 2 uncounterable
    
    static method create(CastBarFinishCast cbfc) -> thistype 
    method launch()
    method channel(integer nodes)
}
</pre>

<div class="items"><a name="DamageSystem"></a>DamageSystem</div>
<pre class="docs">
boolean lifelock = true;

type ResponseDamaged extends function();    
type ResponseOnDamage extends function();    
type ResponseHealed extends function();  

function RegisterDamagedEvent (ResponseDamaged responseDamaged)      
function RegisterOnDamageEvent (ResponseOnDamage responseOnDamage)     
function RegisterHealedEvent (ResponseHealed responseHealed) 
function HealTarget(unit a, unit b, real amount, string hName, real exCrit)
function DamageTarget(unit a, unit b, real amount, string dmgName, boolean isPhyx, boolean criticable, boolean dodgable, weapontype wtype)

struct DamageResult {
    static unit source, target;
    static string abilityName;
    static real amount;
    static boolean isHit;
    static boolean isBlocked;
    static boolean isDodged;
    static boolean isCritical;
    static boolean isImmune;
    static real extraCrit;
}

struct HealResult {
    static unit source, target;
    static string abilityName;
    static real amount;
    static real effective;
    static boolean isCritical;
}
</pre>

<div class="items"><a name="MultipleAbility"></a>MultipleAbility</div>
<pre class="docs">
struct MultipleAbility {
    static Table ht;
    integer primary;
    integer secondary;
    integer tertiary;
    
    method setTertiary(integer tertiary)    
    method showPrimary(player p)     
    method showSecondary(player p)    
    static method register(integer primary, integer secondary)     
    static method operator[] (integer primary) -> thistype    
    static method syncro() -> boolean 
}
</pre>

<div class="items"><a name="PlayerUnitList"></a>PlayerUnitList</div>
<pre class="docs">
struct PlayerUnits {
    static integer n;
    static unit units[];
    
    static method locate(unit u) -> integer         
    static method remove(integer i)         
    static method delete(unit u)         
    static method add(unit u)
}
</pre>

<div class="items"><a name="Projectile"></a>Projectile</div>
<pre class="docs">
type ProjectileReaches extends function(Projectile) -> boolean;

struct Projectile {
    unit caster, target;
    ProjectileReaches pr;
    real speed;
    string path;
    timer tm;
    unit pro;
    effect eff;
    real r0;
    
    method destroy()        
    method reverse()        
    method launch() 
}
</pre>

<div class="items"><a name="SpellReflection"></a>SpellReflection</div>
<pre class="docs">
function TryReflect(unit u) -> boolean 
</pre>

<div class="items"><a name="StunUtils"></a>StunUtils</div>
<pre class="docs">
</pre>

<div class="items"><a name="UnitProperty"></a>UnitProperty</div>
<pre class="docs">
public struct UnitProp {
    static HandleTable ht;      
    unit u;
    real blockRate;         // 0 ~ 0.75; 1 agi = 0.004 block
    real blockPoint;        // 1 str = 1 block
    real dodge;             // 0 ~ 0.75; 1 agi = 0.004 dodge
    integer spellReflect;   // ?
    real aggroRate;         // 0 ~ +oo
    integer armor;          // 0 ~ 75; 1 agi = 0.333 armor
    real spellTaken;        // 0 ~ +oo
    real damageTaken;       // 0 ~ +oo
    real healTaken;         // 0 ~ +oo
    
    boolean disabled; // stunned or spellcountered
    boolean silent; // deprecated
    
    integer life;
    real lifeRegen;         // deprecated
    real manaRegen;         // 0 ~ +oo; 1 int = 0.03 regen
    integer str, agi, int;
    
    real attackCrit;        // 0 ~ 0.75; 1 agi = 0.0025 critic
    real spellCrit;         // 0 ~ 0.95; 1 int = 0.003 critic
    integer attackSpeed;    // -oo ~ +oo
    real spellHaste;
    integer attackPower;    // 0 ~ +oo; main attribute
    real damageDealt;       // 0 ~ +oo
    real attackRate;        // 0.25 ~ 1.00
    
    static method operator[] (unit u) -> thistype        
    static method create() -> thistype 
    
    method BlockRate() -> real         
    method BlockPoint() -> real         
    method Dodge() -> real         
    method SpellReflect() -> integer            
    method AggroRate() -> real         
    method Armor() -> real          
    method SpellTaken() -> real         
    method DamageTaken() -> real         
    method HealTaken() -> real           
    method Disabled() -> boolean         
    method ManaRegen() -> real         
    method AttackCrit() -> real         
    method SpellCrit() -> real         
    method AttackSpeed() -> integer           
    method SpellHaste() -> real     
    method AttackPower() -> real     
    method APMin() -> integer     
    method APMax() -> integer         
    method SpellPower() -> real         
    method Speed() -> integer         
    method ModSpeed(integer mod)         
    method DamageDealt() -> real         
    method AttackRate() -> real       
    method ModSpellReflect(integer mod)    
    method ModArmor(integer m)            
    method ModAttackSpeed(integer mod)       
} 
</pre>

<div class="items"><a name="ZAMCore"></a>ZAMCore</div>
<pre class="docs">
region MAP_AREA;

type UnitEventResponse extends function(unit);

function IsUnitDummy(unit u) -> boolean 
function IsUnitDead(unit u) -> boolean 
function IsUnitStealth(unit u) -> boolean     
function DummyFilter() -> boolean     
function DummyDeadFilter() -> boolean 
function RegisterUnitEnterMap(UnitEventResponse r) 
function RegisterUnitDeath(UnitEventResponse r)     
</pre>


</body>
</html>
